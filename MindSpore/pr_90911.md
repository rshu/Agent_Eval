## Prompt v1 — Original PR Issue Description

**Task:**
You are an automated coding agent. Fix the reported **bug** in MindSpore and add a regression test.

**Repo Link:**
[https://gitee.com/mindspore/mindspore](https://gitee.com/mindspore/mindspore)

**Problem Statement:**
This is a **/kind bug** PR.
Fix a runtime error when computing gradients of **`mint.cumsum`** under **dynamic-rank** mode. In dynamic-rank scenarios, the input tensor shape may be represented like `[-2,]`, which means the framework cannot reliably infer dimension sizes (e.g., whether a specified dim has size 1) purely from static shape metadata. This can lead to an error like:
`RuntimeError: Failure info [For CumsumExt grad, got an invalid dim: 0]`.

Add a smoke/regression test to validate that **`mint.cumsum` gradient** executes correctly under **dynamic rank**.

**Deliverable:**
Generate a standard **git-style patch file** (unified diff, i.e., .patch file) that implements the feature and adds/updates the necessary tests.

---

## Prompt v2 — Weaker / More Vague Issue Description

**Task:**
You are an automated coding agent. Fix an issue in MindSpore and ensure it is covered by tests.

**Repo Link:**
[https://gitee.com/mindspore/mindspore](https://gitee.com/mindspore/mindspore)

**Problem Statement:**
Fix a bug where `mint.cumsum` gradient can fail in dynamic-shape/dynamic-rank execution, and add a regression test to ensure it works.

**Deliverable:**
Generate a standard **git-style patch file** (unified diff, i.e., .patch file) that implements the feature and adds/updates the necessary tests.

---

## Prompt v3 — Original Description + Relevant Files List

**Task:**
You are an automated coding agent. Fix the reported **bug** in MindSpore affecting `mint.cumsum` gradient under dynamic rank, focusing on the relevant files listed below, and add a regression test.

**Repo Link:**
[https://gitee.com/mindspore/mindspore](https://gitee.com/mindspore/mindspore)

**Problem Statement:**
This is a **/kind bug** PR.
Fix a runtime error when computing gradients of **`mint.cumsum`** under **dynamic-rank** mode. In dynamic-rank scenarios, the input tensor shape may be represented like `[-2,]`, which means the framework cannot reliably infer dimension sizes (e.g., whether a specified dim has size 1) purely from static shape metadata. This can lead to an error like:
`RuntimeError: Failure info [For CumsumExt grad, got an invalid dim: 0]`.

Add a smoke/regression test to validate that **`mint.cumsum` gradient** executes correctly under **dynamic rank**.

**Relevant files to update (non-exhaustive but recommended focus):**

* `mindspore/ccsrc/frontend/expander/grad/grad_math_ops.cc` (gradient expansion / validation for math ops such as cumsum in graph/expander path)
* `tests/st/mint/test_cumsum.py` (system/smoke tests for `mint.cumsum`, including adding the dynamic-rank grad case)

**Deliverable:**
Generate a standard **git-style patch file** (unified diff, i.e., .patch file) that implements the feature and adds/updates the necessary tests.

