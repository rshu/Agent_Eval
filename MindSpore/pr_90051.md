## Prompt v1 — Original PR Issue Description

**Task:**
You are an automated coding agent. Fix the reported **accuracy bug** in MindSpore’s auto-parallel static-graph execution involving FlashAttentionScore, and add/adjust tests to prevent regressions.

**Repo Link:**
[https://gitee.com/mindspore/mindspore](https://gitee.com/mindspore/mindspore)

**Problem Statement:**
This is a **/kind bug** PR. 
In **static-graph auto-parallel** training, when using **FlashAttentionScore** in **TND mode** under a **TND + CP** scenario, splitting along the **query sequence dimension** can lead to an **accuracy issue** if the input data is **not segmented** (i.e., not chunked/partitioned as expected). The goal is to fix the accuracy mismatch so that results remain within expected error bounds and align with single-card behavior. 

Add or update coverage to validate the scenario described in the PR: FlashAttentionScore (TND), query-seq split in auto-parallel, and unsegmented input data; verify correctness against single-card / expected reference behavior. 

**Deliverable:**
Generate a standard **git-style patch file** (unified diff, i.e., .patch file) that implements the feature and adds/updates the necessary tests.

---

## Prompt v2 — Weaker / More Vague Issue Description

**Task:**
You are an automated coding agent. Fix an auto-parallel accuracy issue and ensure it is covered by tests.

**Repo Link:**
[https://gitee.com/mindspore/mindspore](https://gitee.com/mindspore/mindspore)

**Problem Statement:**
Fix an accuracy mismatch that happens in static-graph auto-parallel when using FlashAttentionScore with certain layouts/splitting strategies, and add a regression test demonstrating the issue is resolved.

**Deliverable:**
Generate a standard **git-style patch file** (unified diff, i.e., .patch file) that implements the feature and adds/updates the necessary tests.

---

## Prompt v3 — Original Description + Relevant Files List

**Task:**
You are an automated coding agent. Fix the reported **accuracy bug** in MindSpore’s auto-parallel static-graph execution involving FlashAttentionScore, focusing on the relevant files listed below, and add/adjust tests.

**Repo Link:**
[https://gitee.com/mindspore/mindspore](https://gitee.com/mindspore/mindspore) 

**Problem Statement:**
This is a **/kind bug** PR. 
In **static-graph auto-parallel** training, when using **FlashAttentionScore** in **TND mode** under a **TND + CP** scenario, splitting along the **query sequence dimension** can lead to an **accuracy issue** if the input data is **not segmented** (i.e., not chunked/partitioned as expected). The goal is to fix the accuracy mismatch so that results remain within expected error bounds and align with single-card behavior. 

Add or update coverage to validate the scenario described in the PR: FlashAttentionScore (TND), query-seq split in auto-parallel, and unsegmented input data; verify correctness against single-card / expected reference behavior. 

**Relevant files to update (non-exhaustive but recommended focus):**

* `mindspore/ccsrc/frontend/parallel/ops_info/flash_attention_score_info.cc` (auto-parallel strategy / op-info logic for FlashAttentionScore) 
* `tests/st/auto_parallel/flash_attention_score.py` (or the nearest existing auto-parallel system test covering FlashAttentionScore TND scenarios)

**Deliverable:**
Generate a standard **git-style patch file** (unified diff, i.e., .patch file) that implements the feature and adds/updates the necessary tests.

